<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>信息安全管理与评估-应急响应</title>
      <link href="/2024/08/09/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E4%B8%8E%E8%AF%84%E4%BC%B0-%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/"/>
      <url>/2024/08/09/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E4%B8%8E%E8%AF%84%E4%BC%B0-%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/</url>
      
        <content type="html"><![CDATA[<h2 id="什么是应急响应"><a href="#什么是应急响应" class="headerlink" title="什么是应急响应"></a>什么是应急响应</h2><p>应急响应,指的是在应对突发事件或危机情况时采取的及时有效措施,以控制和减轻事件带来的影响,保障安全。</p><p>在检测到网络安全事件（如黑客攻击、数据泄露、系统入侵等）后，组织采取的一系列预定义的行动和程序，以最小化损失和影响，恢复正常运营，并防止未来的安全威胁。</p><h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><ul><li>0x01：Windows入侵排查</li><li>0x02：Linux入侵排查</li><li>0x03：Windows日志分析</li><li>0x04：Web日志分析</li><li>0x05：MySQL日志分析</li></ul><hr><h2 id="0x01：Windows入侵排查"><a href="#0x01：Windows入侵排查" class="headerlink" title="0x01：Windows入侵排查"></a>0x01：Windows入侵排查</h2><h4 id="1-1、查看服务器中是否存在可疑用户或者新增用户。"><a href="#1-1、查看服务器中是否存在可疑用户或者新增用户。" class="headerlink" title="1.1、查看服务器中是否存在可疑用户或者新增用户。"></a>1.1、查看服务器中是否存在可疑用户或者新增用户。</h4><blockquote><p>检查方法：Win+R -&gt; 输入【<strong>lusrmgr.msc</strong>】命令，查看是否存在可疑账户，如果Administrators的管理员组当中存在可疑用户，提交或者删除。</p></blockquote><h4 id="1-2、是否存在隐藏账号。"><a href="#1-2、是否存在隐藏账号。" class="headerlink" title="1.2、是否存在隐藏账号。"></a>1.2、是否存在隐藏账号。</h4><blockquote><p>①、打开注册表，查看管理员对应键值</p><p><img src="/jpg/080901.png"></p></blockquote><h4 id="1-3、通过日志查看管理员登录时间、用户名和IP是否异常。"><a href="#1-3、通过日志查看管理员登录时间、用户名和IP是否异常。" class="headerlink" title="1.3、通过日志查看管理员登录时间、用户名和IP是否异常。"></a>1.3、通过日志查看管理员登录时间、用户名和IP是否异常。</h4><blockquote><p>①、Win+R 打开运行，输入“<strong>eventvwr.msc</strong>”，打开“事件查看器”。</p><p>②、直接按下 Win键 ，搜索“事件查看器”。（系统版本可能存在不同）</p><p>③、通过Windows常用事件ID筛选题目或者想要查询的日志类型和具体内容。（常见Windows事件ID详情<strong>0x03</strong>。）</p><img src="/jpg/080902.png" style="zoom:150%;" /></blockquote><h4 id="1-4、查看异常的端口、进程和可疑IP及连接。"><a href="#1-4、查看异常的端口、进程和可疑IP及连接。" class="headerlink" title="1.4、查看异常的端口、进程和可疑IP及连接。"></a>1.4、查看异常的端口、进程和可疑IP及连接。</h4><blockquote><p><strong>netstat -ano</strong> 查看目前的网络连接情况，找到可疑的<strong>ESTABLISHED</strong>以及<strong>PID</strong></p><img src="/jpg/080903.png" style="zoom:150%;" /></blockquote><h4 id="1-5、检查系统启动项、计划任务和服务"><a href="#1-5、检查系统启动项、计划任务和服务" class="headerlink" title="1.5、检查系统启动项、计划任务和服务"></a>1.5、检查系统启动项、计划任务和服务</h4><blockquote><p>①、启动项</p><p>a、单击【开始】-&gt; 【所有程序】-&gt; 【启动】，默认情况下这里面是一个空目录，确认是否有非正常的程序或者脚本在该目录下存在。</p><p>b、【C:\Users\Administrator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup】此路径同上</p><p>c、按住win+R 输入【<strong>shell:startup</strong>】，即可调出<strong>启动</strong>目录</p><img src="/jpg/080904.png" style="zoom:150%;" /><p>d、按住 win+R 输入【<strong>msconfig</strong>】，查看是否存在命名异常的启动项。</p><img src="/jpg/080905.png" style="zoom:150%;" /><p>e、按住 Win+R 输入【<strong>regedit</strong>】，打开注册表查看以下三个注册表项，验证开机启动项是否正常。</p><p>HKEY_CURRENT_USER\software\micorsoft\windows\currentversion\run </p><p>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run</p><p>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Runonce</p><p>f、按住 Win+R 输入【gpedit.msc】，打开组策略（win11无法用这个命令打开）检查是否有脚本自启动。</p><p>②、计划任务</p><p>a、打开【控制面板】-&gt; 【Windows工具】-&gt;【任务计划】,查看木马后门的文件路径，对其进一步查杀。</p><img src="/jpg/080906.png" style="zoom:150%;" /><p>b、【<strong>CMD</strong>】-&gt; 输入【<strong>at</strong>】(win11已经弃用<strong>at</strong>命令，使用<strong>schtasks.exe</strong>命令，原理相同)，检查计算机与网络上其他计算机之间的会话或者计划任务。</p><p>!(C:\Users\刘华\AppData\Roaming\Typora\typora-user-images\image-20240505101018631.png)</p><img src="/jpg/080907.png" style="zoom:150%;" /><p>③、服务自启动</p><p>a、按住Win+R 输入 【<strong>services.msc</strong>】注意服务状态和启动类型，检查是否异常。</p><img src="/jpg/080908.png" style="zoom:150%;" /></blockquote><hr><h2 id="0x02：Linux入侵排查"><a href="#0x02：Linux入侵排查" class="headerlink" title="0x02：Linux入侵排查"></a>0x02：Linux入侵排查</h2><h4 id="2-1-账号安全"><a href="#2-1-账号安全" class="headerlink" title="2.1 账号安全"></a>2.1 账号安全</h4><blockquote><p>1.用户信息文件：&#x2F;etc&#x2F;passwd</p><img src="/jpg/080909.png" style="zoom:150%;" /><p>用户名：密码：用户ID：组ID：用户说明：家目录</p><p>注意：无密码只允许本机登录，不能远程登录。</p><p>2.影子文件：&#x2F;etc&#x2F;shadow</p><img src="/jpg/080910.png" style="zoom:150%;" /><p>用户名：加密密码：密码最后一次修改日期：两次密码的修改时间间隔：密码有效期：密码修改到期到的警告天数：密码过期之 后的宽限天数：账号失效时间：保留</p></blockquote><h4 id="2-2-入侵排查"><a href="#2-2-入侵排查" class="headerlink" title="2.2 入侵排查"></a>2.2 入侵排查</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">①、通过history命令查看此账号执行过的系统命令，根据命令判断此账号进行了什么行为。</span><br><span class="line">②、查看异常端口</span><br><span class="line">netstat -antlp|more</span><br><span class="line">查看PID所对应的进程文件路径</span><br><span class="line">③、使用ps命名，分析进程：</span><br><span class="line">ps -aux|grep pid</span><br></pre></td></tr></table></figure><h4 id="2-3-开机启动配置文件"><a href="#2-3-开机启动配置文件" class="headerlink" title="2.3 开机启动配置文件"></a>2.3 开机启动配置文件</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/etc/rc.local</span><br><span class="line">/etc/rc.d/rc[0-6].d</span><br></pre></td></tr></table></figure><img src="/jpg/080911.png" style="zoom:150%;" /><img src="/jpg/080912.png" style="zoom:150%;" /><h4 id="2-4-排查定时任务"><a href="#2-4-排查定时任务" class="headerlink" title="2.4 排查定时任务"></a>2.4 排查定时任务</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1、crontab</span><br><span class="line">crontab -l 列出某个用户cront服务的详细内容</span><br><span class="line">crontab -r 删除每个用户cront任务</span><br><span class="line">crontab -e 编辑当前的crontab文件</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">重点关注以下目录是否存在恶意脚本</span><br><span class="line"></span><br><span class="line">/var/spool/cron/*</span><br><span class="line">/etc/crontab</span><br><span class="line">/etc/cron.d/*</span><br><span class="line">/etc/cron.daily/*</span><br><span class="line">/etc/cron.hourly/*</span><br><span class="line">/etc/cron.monthly/*</span><br><span class="line">/etc/cron.weekly/</span><br><span class="line">/etc/anacrontab</span><br><span class="line">/var/spool/anacron/*</span><br></pre></td></tr></table></figure><h4 id="2-5-排查系统日志"><a href="#2-5-排查系统日志" class="headerlink" title="2.5 排查系统日志"></a>2.5 排查系统日志</h4><p>日志默认存放位置：&#x2F;var&#x2F;log&#x2F;</p><p>查看日志配置情况：cat &#x2F;etc&#x2F;rsyslog.conf</p><table><thead><tr><th align="center">日志文件路径</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">&#x2F;var&#x2F;log&#x2F;secure</td><td align="center">记录验证和授权方面的信息，只要涉及账号和密码的程序都会记录，比如SSH登录，su切换 用户，sudo授权，甚至添加用户和修改用户密码都会记录在这个日志文件中</td></tr><tr><td align="center">&#x2F;var&#x2F;log&#x2F;cron</td><td align="center">记录了系统定时任务相关的日志</td></tr><tr><td align="center">&#x2F;var&#x2F;log&#x2F;cups</td><td align="center">记录打印信息的日志</td></tr><tr><td align="center">&#x2F;var&#x2F;log&#x2F;dmesg</td><td align="center">记录了系统在开机时内核自检的信息，也可以使用dmesg命令直接查看内核自检信息</td></tr><tr><td align="center">&#x2F;var&#x2F;log&#x2F;mailog</td><td align="center">记录邮件信息</td></tr><tr><td align="center">&#x2F;var&#x2F;log&#x2F;message</td><td align="center">记录系统重要信息的日志。这个日志文件中会记录Linux系统的绝大多数重要信息，如果系 统出现问题时，首先要检查的就应该是这个日志文件</td></tr><tr><td align="center">&#x2F;var&#x2F;log&#x2F;btmp</td><td align="center">记录错误登录日志，这个文件是二进制文件，不能直接vi查看，而要使用lastb命令查看</td></tr><tr><td align="center">&#x2F;var&#x2F;log&#x2F;lastlog</td><td align="center">记录系统中所有用户最后一次登录时间的日志，这个文件是二进制文件，不能直接vi，而要 使用lastlog命令查看</td></tr><tr><td align="center">&#x2F;var&#x2F;log&#x2F;wtmp</td><td align="center">永久记录所有用户的登录、注销信息，同时记录系统的启动、重启、关机事件。同样这个文 件也是一个二进制文件，不能直接vi，而需要使用last命令来查看</td></tr><tr><td align="center">&#x2F;var&#x2F;log&#x2F;utmp</td><td align="center">记录当前已经登录的用户信息，这个文件会随着用户的登录和注销不断变化，只记录当前登 录用户的信息。同样这个文件不能直接vi，而要使用w,who,users等命令来查询</td></tr></tbody></table><h4 id="2-6-日志分析小技巧"><a href="#2-6-日志分析小技巧" class="headerlink" title="2.6 日志分析小技巧"></a>2.6 日志分析小技巧</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">awk 命令</span><br><span class="line">grep 命令</span><br><span class="line">sed 命令</span><br><span class="line">find 命令</span><br><span class="line">sort 命令</span><br><span class="line">uniq 命令</span><br><span class="line">top 命令</span><br><span class="line">last 命令</span><br><span class="line">xargs 命令</span><br><span class="line">netstat 命令</span><br><span class="line">more 命令</span><br><span class="line">diff 命令</span><br><span class="line"></span><br><span class="line">***// 以上Linux常用命令的所有语法及用法必须完全记住</span><br></pre></td></tr></table></figure><hr><h2 id="0x03：Windows日志分析"><a href="#0x03：Windows日志分析" class="headerlink" title="0x03：Windows日志分析"></a>0x03：Windows日志分析</h2><p>上述0x01当中已经讲过Windows的日志所在路径和方法，这次不再过多赘述</p><p>对于不同的Windows日志分析，有着不同的事件ID，下面是一些常见的事件ID ,也是2024年省赛用到的一些事件ID。</p><table><thead><tr><th align="center">事件ID</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">4624</td><td align="center">登录成功</td></tr><tr><td align="center">4625</td><td align="center">登录失败</td></tr><tr><td align="center">4634</td><td align="center">注销成功</td></tr><tr><td align="center">4647</td><td align="center">用户启动的注销</td></tr><tr><td align="center">4672</td><td align="center">使用管理员进行登录</td></tr><tr><td align="center">4720</td><td align="center">创建用户</td></tr></tbody></table><p>此外还有很多事件ID，这里不再一一描述，遇到之后去百度搜索就可以。</p><blockquote><p>可以利用eventlog事件来查看系统账号登录情况：</p><ol><li><p>在“开始”菜单上，依次指向“所有程序”、“管理工具”，然后单击“事件查看器”；</p></li><li><p>在事件查看器中，单击“安全”，查看安全日志；</p></li><li><p>在安全日志右侧操作中，点击“筛选当前日志”，输入事件ID进行筛选。 </p><p>4624 –登录成功 </p><p>4625 –登录失败 </p><p>4634 – 注销成功 </p><p>4647 – 用户启动的注销 </p><p>4672 – 使用超级用户（如管理员）进行登录</p><p> 我们输入事件ID：4625进行日志筛选，发现事件ID：4625，事件数175904，即用户登录失败了175904次，那么这台服务器管理员账号可能遭遇了暴力猜解。</p></li></ol></blockquote><img src="/jpg/080913.png" style="zoom:150%;" /><hr><h2 id="0x04：Web日志分析"><a href="#0x04：Web日志分析" class="headerlink" title="0x04：Web日志分析"></a>0x04：Web日志分析</h2><p>常见的中间件：Apache、Nginx、Tomcat、IIS、Weblogic</p><img src="/jpg/080914.png" style="zoom:150%;" /><p>这是一条Apache的访问日志，这里可以清楚的看到访问者的IP地址，访问事件，请求方式GET&#x2F;POST，访问时所用的操作系统和浏览器的内核版本，以及访问的哪个页面和回显是否正常等。</p><p>Linux下，可以配合Shell+Linux命令实现日志分析：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1、列出日志当中访问次数最多的IP：</span><br><span class="line">cat log_file |awk &#x27;&#123;print($1)&#125;&#x27; |uniq -c |sor      //详细可以去看一看awk，uniq，sort命令的详细用法</span><br><span class="line">仅提供排查思路，命令的用法自己发挥</span><br><span class="line">2、列出日志当中成功访问的记录：</span><br><span class="line">cat log_file |grep 200</span><br><span class="line">3、列出日志当中成功被hacker上传的后门记录：</span><br><span class="line">cat log_file |grep 200 |grep POST</span><br></pre></td></tr></table></figure><p>应急响应中身为蓝队人员要做好防护职责，最好的防护思路就是读懂红队人员的攻击思路和攻击手段，用反方向的思维去做好防护。  <strong>—仅个人理解</strong>，简单点就是<strong>“知攻善防”</strong></p><p><strong>所有中间件的日志都默认存放在不同的路径下，这里需要你个人积累。</strong></p><hr><h2 id="0x05：MySQL日志分析"><a href="#0x05：MySQL日志分析" class="headerlink" title="0x05：MySQL日志分析"></a>0x05：MySQL日志分析</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1、查看log配置信息：</span><br><span class="line">show variables like &#x27;%general%&#x27;;</span><br><span class="line">2、开启日志：</span><br><span class="line">SET GLOBAL general_log=&#x27;On&#x27;;</span><br><span class="line">3、指定日志文件路径：</span><br><span class="line">#SET GLOBAL general_log_file=&#x27;/var/lib/mysql/mysql.log&#x27;;</span><br></pre></td></tr></table></figure><p>例如：当访问&#x2F;Demo.php?id&#x3D;1,此时得到这样的日志：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">240501 10:01:20          14 Connect    root@localhost on</span><br><span class="line">            20  Init DB      Demo</span><br><span class="line">            20  Query        SELECT * FROM admin WHERE id=1</span><br><span class="line">            20  Quit</span><br></pre></td></tr></table></figure><p>日志解读：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">第一列：时间列，前面是日期，后面是小时和分钟，另外有些sql语句几乎是同时执行，所以就不会另外再记录时间。</span><br><span class="line">第二列：ID，就是show processlist出来的第一列的线程ID。</span><br><span class="line">第三列：Command，操作类型，比如：Connect就是连接数据库，Query就是查询数据库（增删改查都显示为查询）。</span><br><span class="line">第四列：Argument，详细信息，比如root@localhost on就是连接数据库，以此类推，下面就是连接数据库之后做了什么操作。</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
  
  
    
    
    <entry>
      <title></title>
      <link href="/music/index.html"/>
      <url>/music/index.html</url>
      
        <content type="html"><![CDATA[<!-- #<script>console.error("Error: [hexo-tag-aplayer] Meting support is disabled, cannot resolve the meting tags properly.");</script><div class="aplayer" data-id="8492133976" data-server="netease" data-type="playlist"  data-fixed="true" data-theme="#3F51B5"></#div> --><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=795 height=550 src="//music.163.com/outchain/player?type=0&id=6678743774&auto=1&height=430"></iframe>]]></content>
      
    </entry>
    
    
    
    <entry>
      <title>标签</title>
      <link href="/tags/tags.html"/>
      <url>/tags/tags.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
    </entry>
    
    
  
</search>
